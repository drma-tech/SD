"use strict";function share(n){if(!("share"in navigator)||window.isSecureContext===!1){showError("Web Share API not supported.");return}navigator.share({url:n}).then(()=>console.log("Successful share")).catch(n=>showError(n.message))}function GetLocalStorage(n){return window.localStorage.getItem(n)}function SetLocalStorage(n,t){if(typeof n!="string"||typeof t!="string"){showError("Key/value must be strings");return}return window.localStorage.setItem(n,t)}function TryDetectPlatform(){if(!GetLocalStorage("platform")){let n=document.referrer=="app-info://platform/microsoft-store",t=document.referrer?.includes("android-app://"),i=document.cookie.split("; ").some(n=>n==="app-platform=iOS App Store");n?SetLocalStorage("platform","windows"):t?SetLocalStorage("platform","play"):i?SetLocalStorage("platform","ios"):SetLocalStorage("platform","webapp")}}async function getUserInfo(){try{if(window.location.host.includes("localhost"))return null;else{const n=await fetch("/.auth/me");if(!n.ok)throw new Error(`HTTP ${n.status}`);const t=await n.json();return t?.clientPrincipal?.userId||null}}catch(n){return showError(n.message),null}}function showError(n){if(window.DotNet)try{DotNet.invokeMethodAsync("SD.WEB","ShowError",n)}catch{showToast(n)}else showToast(n)}function showToast(n){const t=document.getElementById("error-container");t&&(t.textContent=n,t.style.display="block",setTimeout(()=>{t.style.display="none"},5e3))}function changeDarkMode(){let n=GetLocalStorage("theme");n=n=="light"?"dark":"light";SetLocalStorage("theme",n);document.body.setAttribute("data-bs-theme",n)}function animationShake(n){const t=document.querySelectorAll(n);t.forEach(n=>{n.classList.add("shake"),setTimeout(()=>n.classList.remove("shake"),300)});navigator.vibrate&&navigator.vibrate(200)}function animationBlink(n){const t=document.querySelectorAll(n);t.forEach(n=>{n.classList.add("blink"),setTimeout(()=>{n.classList.remove("blink")},1500)})}async function detectBrowserFeatures(){const[n,t,i]=await Promise.all([wasmFeatureDetect.simd(),wasmFeatureDetect.bulkMemory(),wasmFeatureDetect.bigInt()]);return!n||!t||!i?(showBrowserWarning(),!1):!0}function showBrowserWarning(){document.body.innerHTML=`
        <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background: #f0f2f5; font-family: 'Segoe UI', Roboto, sans-serif; padding: 1rem;">
            <div style="background: #fff; padding: 0.6rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-width: 460px; text-align: center; color: #333;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">⚠️</div>
                <h2 style="font-size: 1.5rem; margin-bottom: 0.5rem;">Your browser needs an update</h2>
                <p style="font-size: 1rem; line-height: 1.6; margin-bottom: 0.5rem; text-align: justify;">
                    This app uses modern browser features. Your current browser version isn’t compatible. Even when installed from a store, this app runs inside your device’s built-in browser.
                </p>
                <ul style="list-style: none; padding: 0; margin: 0; font-size: 0.95rem; color: #555; text-align: left; padding-top: 0.5rem;">
                    <li style="margin: 0.5rem 0; text-align: center;">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v11/icons/googleplay.svg" alt="Play Store" width="20" style="margin-right: 4px;" />
                        <strong>Android</strong>: uses <strong>Chrome</strong>
                    </li>
                    <li style="margin: 0.5rem 0; text-align: center;">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v11/icons/apple.svg" alt="App Store" width="20" style="margin-right: 4px;" />
                        <strong>iOS/macOS</strong>: uses <strong>Safari</strong>
                    </li>
                    <li style="margin: 0.5rem 0; text-align: center;">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v11/icons/microsoftstore.svg" alt="Microsoft Store" width="20" style="margin-right: 4px;" />
                        <strong>Windows</strong>: uses <strong>Edge</strong>
                    </li>
                </ul>
            </div>
        </div>
    `}