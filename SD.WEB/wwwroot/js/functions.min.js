"use strict";function sendLog(n){const t=window.location.hostname==="localhost"?"http://localhost:7071":"";fetch(`${t}/api/public/logger`,{method:"POST",headers:{"Content-Type":"application/json"},body:n}).catch(()=>{})}function jsSaveAsFile(n,t,i){const f=new File([i],n,{type:t}),u=URL.createObjectURL(f),r=document.createElement("a");document.body.appendChild(r);r.href=u;r.download=n;r.target="_self";r.click();URL.revokeObjectURL(u)}function GetLocalStorage(n){return window.localStorage.getItem(n)}function SetLocalStorage(n,t){return typeof n!="string"||typeof t!="string"?(showError("Key/value must be strings"),null):window.localStorage.setItem(n,t)}function LoadAppVariables(){if(!GetLocalStorage("platform")){const n=document.referrer=="app-info://platform/microsoft-store"||/microsoft-store/i.test(navigator.userAgent),t=/(android)/i.test(navigator.userAgent),i=/iphone|ipad|ipod/i.test(navigator.userAgent),r=/macintosh|mac os x/i.test(navigator.userAgent),u=/huawei|honor/i.test(navigator.userAgent),f=/xiaomi/i.test(navigator.userAgent);n?SetLocalStorage("platform","windows"):t?SetLocalStorage("platform","play"):i||r?SetLocalStorage("platform","ios"):u?SetLocalStorage("platform","huawei"):f?SetLocalStorage("platform","xiaomi"):SetLocalStorage("platform","webapp")}GetLocalStorage("app-language")||/webtonative/i.test(navigator.userAgent)&&WTN.deviceInfo().then(function(n){SetLocalStorage("WTN.deviceInfo",n);SetLocalStorage("app-language",n.language);location.reload()})}async function getUserInfo(){try{let t=JSON.parse(GetLocalStorage("msal.account.keys"));if(!t)return null;let n=JSON.parse(GetLocalStorage(t[0]));return{userId:n.localAccountId,name:n.name,email:n.idTokenClaims.email}}catch(n){return showError(n.message),null}}function showError(n){if(window.DotNet)try{DotNet.invokeMethodAsync("SD.WEB","ShowError",n)}catch{showToast(n)}else showToast(n)}function showToast(n){const t=document.getElementById("error-container");t&&(t.textContent=n,t.style.display="block",setTimeout(()=>{t.style.display="none"},1e4))}function showBrowserWarning(){const n=getOperatingSystem(),t=getBrowserName(),i=getBrowserVersion();document.body.innerHTML=`
        <div style="display:flex; align-items:center; justify-content:center; min-height:100vh; background:#f0f2f5; font-family:'Segoe UI', Roboto, sans-serif; padding:1rem;">
            <div style="background:#fff; padding:1.2rem; border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.1); width:100%; max-width:380px; text-align:center; color:#333;">
                <div style="font-size:2.2rem; margin-bottom:0.5rem;">⚠️</div>
                <h2 style="font-size:1.3rem; margin-bottom:0.75rem;">Your browser is too old</h2>
                <p style="font-size:1rem; line-height:1.5; margin-bottom:1rem;">
                    This app can’t run on your current browser because it is out of date.
                    Please update your device using the instructions below.
                </p>
                <div style="text-align:left; font-size:1rem; color:#444;">
                    <div style="margin:0.8rem 0; display:flex; align-items:center;">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v11/icons/googleplay.svg" width="22" style="margin-right:8px;" />
                        <span><strong>Android:</strong> update <strong>Google Chrome</strong> in the Play Store</span>
                    </div>
                    <div style="margin:0.8rem 0; display:flex; align-items:center;">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v11/icons/apple.svg" width="22" style="margin-right:8px;" />
                        <span><strong>iOS / macOS:</strong> update your system (Safari is included)</span>
                    </div>
                    <div style="margin:0.8rem 0; display:flex; align-items:center;">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v11/icons/windows.svg" width="22" style="margin-right:8px;" />
                        <span><strong>Windows:</strong> run Windows Update (Edge is included)</span>
                    </div>
                </div>
                <div style="background:#f9fafb; border-radius:12px; padding:0.8rem; font-size:0.95rem; color:#444; margin-bottom:1rem;">
                    <strong>Detected environment:</strong><br>
                    ${n}<br>
                    ${t} ${i}
                </div>
                <p style="font-size:0.9rem; color:#777; margin-top:1.2rem; text-align:center;">
                    If you cannot update, try opening this app on a newer device.
                </p>
            </div>
        </div>
    `}function getBrowserName(){const n=navigator.userAgent;return n.includes("Firefox/")?"Firefox":n.includes("Edg/")?"Edge":n.includes("Chrome/")?"Chrome":n.includes("Safari/")?"Safari":n.includes("OPR/")?"Opera":n.includes("MSIE")||n.includes("Trident/")?"Internet Explorer":"Unknown"}function getBrowserVersion(){const t=navigator.userAgent,n=RegExp(/(Firefox|Edg|Chrome|Safari|Version)\/([0-9.]+)/).exec(t);return n?n[2]:"unknown"}function getOperatingSystem(){const n=navigator.userAgent;return n.includes("Windows")?"Windows":n.includes("Mac")?"Mac OS":n.includes("Linux")?"Linux":n.includes("Android")?"Android":n.includes("iOS")||n.includes("iPhone")||n.includes("iPad")?"iOS":"Unknown"}window.checkBrowserFeatures=async function(){const n=typeof WebAssembly=="object",t=await wasmFeatureDetect.simd().catch(()=>!1);if(!n||!t){const i={env:`${getOperatingSystem()} | ${getBrowserName()} | ${getBrowserVersion()}`,app:`${GetLocalStorage("platform")} | ${GetLocalStorage("app-version")}`,features:`wasm-${n} | simd-${t}`,userAgent:navigator.userAgent,url:window.location.href};if(sendLog(`browser with limited resources: ${JSON.stringify(i)}`),!n){showBrowserWarning();return}if(!t){showError("Your browser is out of date or some security mechanism is blocking something essential for the platform to function properly, such as Edge's Enhanced Security Mode.");return}}Promise.withResolvers||(showError("Your system’s web engine is outdated and may not support all features. Please update your device or browser to ensure the best experience."),Promise.withResolvers=function(){let n,t;const i=new Promise((i,r)=>{n=i,t=r});return{promise:i,resolve:n,reject:t}})};window.alertEffects={playBeep:(n,t,i)=>{try{const r=new(window.AudioContext||window.webkitAudioContext),u=r.createOscillator(),f=r.createGain();u.type=i;u.frequency.setValueAtTime(n,r.currentTime);f.gain.setValueAtTime(.1,r.currentTime);u.connect(f);f.connect(r.destination);u.start();u.stop(r.currentTime+t/1e3)}catch(r){console.warn("Audio playback failed:",r)}},vibrate:n=>{navigator.vibrate&&navigator.vibrate(n)}};window.clearLocalStorage=()=>{localStorage.clear()};window.showCache=()=>{showToast("userAgent: "+navigator.userAgent+", app-language: "+GetLocalStorage("app-language")+", app-version: "+GetLocalStorage("app-version")+", country: "+GetLocalStorage("country")+", platform: "+GetLocalStorage("platform")+", WTN.deviceInfo: "+GetLocalStorage("WTN.deviceInfo"))};