"use strict";async function requestMessagingPermission(){const t=GetLocalStorage("platform");if(["ios","play","xiaomi"].includes(t)){console.log("Using native push, no web permission needed.");return}const i=await Notification.requestPermission();if(i!=="granted"){console.warn("Notifications not allowed.");return}const n=await messaging.getToken({vapidKey:"BJ31lWbRBbX3ZyyUHG_pQB7ZmjFtNeFjhbhuyMwUvotpXsTej5iloeSA7GdCbC7HUo314KtgMxIvXiwygAG8NhQ"});if(n)SetLocalStorage("MessagingToken",n);else{showError("Failed to register messaging token.");return}await invokeDotNetWhenReady("SD.WEB","SubscribeToTopics",{token:n,platform:t})}const firebaseConfig={apiKey:"AIzaSyDj5LpsT7-bra4hvuvb5E_BPSlD7Wr29nQ",authDomain:"streaming-discovery-4c483.firebaseapp.com",projectId:"streaming-discovery-4c483",storageBucket:"streaming-discovery-4c483.firebasestorage.app",messagingSenderId:"394152837411",appId:"1:394152837411:web:06b7216d2859bdc1224c96",measurementId:"G-JKXTVXM0EX"};firebase.initializeApp(firebaseConfig);const auth=firebase.auth(),messaging=firebase.messaging();auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);window.firebaseAuth={signIn:async n=>{const i={google:new firebase.auth.GoogleAuthProvider,apple:new firebase.auth.OAuthProvider("apple.com"),facebook:new firebase.auth.FacebookAuthProvider,microsoft:new firebase.auth.OAuthProvider("microsoft.com"),yahoo:new firebase.auth.OAuthProvider("yahoo.com"),x:new firebase.auth.TwitterAuthProvider},t=i[n];if(!t)throw new Error(`Unsupported provider: ${n}`);try{await auth.signInWithRedirect(t)}catch(r){throw new Error(r.message);}},signOut:async()=>{try{await auth.signOut()}catch(n){throw new Error(n.message);}}};auth.getRedirectResult().then(async n=>{if(n.credential){let i=n.credential,t=i.accessToken;showToast(t);await invokeDotNetWhenReady("SD.WEB","AuthChanged",t)}});messaging.onMessage(n=>{if(Notification.permission==="granted"){const{title:t,body:i}=n.data||{};new Notification(t,{body:i})}});