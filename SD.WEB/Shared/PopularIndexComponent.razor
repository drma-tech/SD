@using SD.WEB.Modules.Collections.Core
@using SD.WEB.Modules.Platform.Resources
@inherits ComponentCore<PopularIndexComponent>

@inject ImdbPopularApi ImdbPopularApi

<NewPageSection Title="@Translations.Popular" Description="@GlobalTranslations.PopularIndexDescription" Icon="@IconsFA.Solid.Icon("fire").Font">
    <BodyFragment>
        <MudTabs KeepPanelsAlive="true" MinimumTabWidth="100" ApplyEffectsToContainer="true" TabPanelsClass="@Css.Build().Small("pt")"
                 ActivePanelIndex="@(TypeSelected == PopularType.Movie ? 0 : 1)" ActivePanelIndexChanged="@(async (int index) => { TypeSelected = index == 0 ? PopularType.Movie : PopularType.Show; })">
            <Header>
                <MudTooltip Text="Expand">
                    <MudIconButton Icon="@IconsFA.Solid.Icon("expand").Font" Href="@($"/popular/{TypeSelected}")" Disabled="true" />
                </MudTooltip>
            </Header>
            <ChildContent>
                <MudTabPanel Text="@PopularType.Movie.GetName()">
                    <NewMediaList MediaListApi="ImdbPopularApi" IsImdb="true" OnlyYear="true" StringParameters="Params" TypeSelected="MediaType.movie" Watched="WatchedList" Watching="WatchingList" Wish="WishList">
                    </NewMediaList>
                </MudTabPanel>
                <MudTabPanel Text="@PopularType.Show.GetName()">
                    <NewMediaList MediaListApi="ImdbPopularApi" IsImdb="true" OnlyYear="true" StringParameters="Params" TypeSelected="MediaType.tv" Watched="WatchedList" Watching="WatchingList" Wish="WishList">
                    </NewMediaList>
                </MudTabPanel>
            </ChildContent>
        </MudTabs>
    </BodyFragment>
</NewPageSection>

@code {
    [Parameter][EditorRequired] public WatchedList? WatchedList { get; set; }
    [Parameter][EditorRequired] public WatchingList? WatchingList { get; set; }
    [Parameter][EditorRequired] public WishList? WishList { get; set; }

    public PopularType TypeSelected { get; set; } = PopularType.Movie;

    public Dictionary<string, string> Params { get; set; } = new() { { "mode", "compact" } };
}